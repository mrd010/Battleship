(()=>{"use strict";const t=class{#t;#e;#r;#s;constructor(t){this.#t=t.name,this.#e=t.length,this.#r=0,this.#s=!1}getName(){return this.#t}getLength(){return this.#e}getHitCount(){return this.#r}isPlaced(){return this.#s}fortify(){this.#s=!0}hit(){this.#r+=1}isSunk(){return this.#r>=this.#e}},e=class{#a;#n;#i;#l(){for(let t=0;t<10;t+=1){this.#a[t]=[];for(let e=0;e<10;e+=1)this.#a[t][e]=null}}constructor(){this.#i=[],this.#n=[],this.#a=[],this.#l()}getBoard(){return this.#a}getSquare(t){let[e,r]=t;return this.#a[e][r]}setupShips(e){this.#n=e.map((e=>new t(e)))}#o(t){let[e,r]=t;return e>=0&&e<this.#a.length&&r>=0&&r<this.#a.length}#d(t){const e=[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]];return t.every((t=>{const r=t[0],s=t[1];return this.#o(t)&&null===this.#a[r][s]&&e.every((t=>!this.#o([r+t[0],s+t[1]])||null===this.#a[r+t[0]][s+t[1]]))}))}#h(t,e){return t<=9&&t===e.length&&this.#d(e)}placeShip(t,e,r){if(this.#h(e,r)){const s=this.#n.find((r=>r.getName()===t&&r.getLength()===e&&!r.isPlaced()));if(s)return r.forEach((t=>{this.#a[t[0]][t[1]]=s})),s.fortify(),!0}return!1}isValidShot(t){let[e,r]=t;return this.#o([e,r])&&!this.#i.some((t=>t.coordinates[0]===e&&t.coordinates[1]===r))}#c(t){let[e,r]=t;const s=this.#a[e][r];return s.hit(),this.#i.push({coordinates:[e,r],wasSuccess:!0}),{wasSuccess:!0,destroyed:s.isSunk()}}#u(t){let[e,r]=t;return this.#i.push({coordinates:[e,r],wasSuccess:!1}),{wasSuccess:!1}}receiveAttack(t){let[e,r]=t;return null===this.#a[e][r]?this.#u([e,r]):this.#c([e,r])}allShipsPlaced(){return this.#n.every((t=>t.isPlaced()))}allShipsSunken(){return this.#n.every((t=>t.isSunk()))}randomPlaceShips(){for(let t=this.#n.length-1;t>=0;t-=1){const e=this.#n[t];for(;!e.isPlaced();){const t=Math.random()>.5?"v":"h",r=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()-e.getLength()+1),a=[];for(let n=0;n<e.getLength();n+=1)"h"===t?a.push([r,s+n]):a.push([s+n,r]);this.placeShip(e.getName(),e.getLength(),a)}}return this.#a}},r=class{#p;#m;constructor(t,r){this.#p=new e,this.#p.setupShips(r),this.#m=!1,"ai"===t&&(this.#m=!0,console.log(this.#p.randomPlaceShips()))}isAI(){return this.#m}getGameboard(){return this.#p}placeShip(t,e,r){return this.#p.placeShip(t,e,r)}receiveAttack(t){if(this.#p.isValidShot(t)){const e=this.#p.receiveAttack(t);return{fired:!0,shot:e,win:!!e.destroyed&&this.#p.allShipsSunken()}}return{fired:!1}}isLost(){return this.#p.allShipsSunken()}},s=class{#g;#y;#b;#f;constructor(t){this.#g=null,this.#y=null,this.#f=t}addPlayer(t){const e=new r(t,this.#f);return null===this.#g?(this.#g=e,this.#g):null===this.#y?(this.#y=e,this.#y):null}player(t){return 1===t?this.#g:2===t?this.#y:null}placeShipFor(t,e,r,s){return null!==this.player(t)&&this.player(t).placeShip(e,r,s)}allShipsPlaced(t){return this.player(t).getGameboard().allShipsPlaced()}playTurn(t){const e={playerShotStatus:"invalid",aiShots:[],winner:0},r=this.#y.receiveAttack([t.x,t.y]);if(r.fired){if(r.shot.wasSuccess)return e.playerShotStatus="hit",r.win&&(e.winner=1),e;let t;e.playerShotStatus="miss";do{let r,s;do{r=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()),t=this.#g.receiveAttack([r,s])}while(!t.fired);e.aiShots.push({coordinate:[r,s],shotStatus:t.shot.wasSuccess?"hit":"miss"}),t.win&&(e.winner=2)}while(t.shot.wasSuccess&&0===e.winner)}return e}},a=[{name:"Patrol Boat",length:2},{name:"Patrol Boat",length:2},{name:"Patrol Boat",length:2},{name:"Patrol Boat",length:2},{name:"Destroyer",length:3},{name:"Destroyer",length:3},{name:"Submarine",length:3},{name:"Battleship",length:4},{name:"Battleship",length:4},{name:"Carrier",length:5}];function n(t,e){e.forEach((e=>t.appendChild(e)))}function i(t,e){const r=document.createElement(t);void 0!==e&&r.setAttribute("class",e);for(var s=arguments.length,a=new Array(s>2?s-2:0),n=2;n<s;n++)a[n-2]=arguments[n];return a.forEach((t=>{r.setAttribute(t[0],t[1])})),r}const l=function(t,e){const r=function(t,e){const r=document.createElement(t);void 0!==e&&r.classList.add(e);for(var s=arguments.length,a=new Array(s>2?s-2:0),n=2;n<s;n++)a[n-2]=arguments[n];return a.forEach((t=>{r.setAttribute(t[0],t[1])})),r}("div",void 0);return void 0!==t&&r.setAttribute("class",t),void 0!==e&&r.setAttribute("id",e),r},o=function(){const t=l("grid grid-rows-[auto_minmax(0,1fr)] self-stretch gap-4"),e=l("field-header p-4 m-4");n(e,[i("h2","title text-center text-slate-50 text-2xl font-extrabold"),i("h3","desc text-center text-slate-100 text-md font-bold")]),t.appendChild(e);const r=l("game-board grid place-self-center border-2 rounded-md border-slate-200");r.style.gridTemplateRows="repeat(10, minmax(0, 1fr))",r.style.gridTemplateColumns="repeat(10, minmax(0, 1fr))";for(let t=0;t<10;t+=1)for(let e=0;e<10;e+=1){const s=i("button","w-10 h-10 bg-slate-50/5 border-[1px] border-slate-50/10",["data-row",t],["data-col",e]);s.style.gridArea=`${t+1} / ${e+1} / span 1 / span 1`,r.appendChild(s)}return t.appendChild(r),t},d=function(t){return{x:Number(t.getAttribute("data-col")),y:Number(t.getAttribute("data-row"))}},h=function(t,e,r,s){const a=t.cloneNode();a.classList.add("placeholder");const n=getComputedStyle(e).getPropertyValue("width").slice(0,-2),i=Number(a.getAttribute("data-ship-length")),l="h"===r?i:1,o="v"===r?i:1;a.style.width=n*l+"px",a.style.height=n*o+"px";const d=Math.min(11-l,Math.max(1,s.x+1-Math.floor(l/2))),h=Math.min(11-o,Math.max(1,s.y+1-Math.floor(o/2)));a.style.gridRowStart=`${h}`,a.style.gridColumnStart=`${d}`,a.style.gridRowEnd=`span ${o}`,a.style.gridColumnEnd=`span ${l}`;const c=t.firstChild.cloneNode(!0);return a.appendChild(c),a.removeAttribute("for"),a.style.writingMode="h"===r?"horizontal-tb":"vertical-rl",a.classList.add("-z-10"),a.classList.add("bg-gray-500/50"),a},c=function(t,e){t.querySelector(".placeholder")&&t.querySelector(".placeholder").remove(),t.appendChild(e)},u=function(){const t=function(){const t=new s(a);return t.addPlayer("p"),t.addPlayer("ai"),t}(),e=function(t){const e=l("grid grid-rows-[auto_auto_1fr] grid grid-cols-[1fr_1fr] min-h-screen items-start","play-screen"),r=i("header","p-2 bg-amber-400 border-b-2 col-span-2"),s=i("h1","text-slate-900 font-extrabold font-display text-4xl text-center");s.textContent="Battleship",r.appendChild(s),e.appendChild(r);const a=l("flex flex-wrap col-span-2 flex-row p-4 gap-3 border-b-2","ships-menu");t.forEach(((t,e)=>{const r=l("ship-button grid items-stretch rounded-sm"),s=i("input","peer hidden",["type","radio"],["id",`ship${e}`],["name","ships"],["data-ship-name",t.name],["data-ship-length",t.length]),o=i("label","grid border-2 peer-checked:ring-2 peer-disabled:opacity-30 opacity-80 peer-checked:opacity-100 cursor-pointer ring-red-500 rounded-md overflow-hidden relative text-slate-50 text-sm text-center",["for",`ship${e}`],["data-ship-name",t.name],["data-ship-length",t.length]);o.style.height="2.5rem",o.style.width=2.5*t.length+"rem",o.style.gridTemplateColumns=`repeat(${t.length}, minmax(0, 1fr))`,o.style.gridTemplateRows="repeat(1, minmax(0, 1fr))";const d=l("ship-name text-slate-50 z-10 text-center absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 uppercase");d.textContent=t.name,o.appendChild(d);for(let e=0;e<t.length;e+=1)o.appendChild(l("ship-part odd:bg-slate-700 even:bg-slate-600"));n(r,[s,o]),a.appendChild(r)})),e.appendChild(a);const d=o();d.classList.add("border-r-2"),d.setAttribute("id","player-field"),d.querySelector(".field-header .title").textContent="Place your ships in board",d.querySelector(".field-header .desc").textContent="Select Ship and Place it . Press R for rotate";const h=o();return h.setAttribute("id","opponent-field"),h.querySelector(".field-header .title").textContent="Player2 (AI)",h.classList.add("opacity-20"),n(e,[d,h]),e}(a);document.getElementById("start-screen").remove(),document.body.appendChild(e);let r=null,u=null;e.querySelectorAll("#ships-menu .ship-button").forEach((t=>{t.querySelector("input").addEventListener("change",(e=>{e.target.checked&&(r=e.target,u=t.querySelector("label"))}))}));let p=null,m={x:0,y:0},g="h";const y=e.querySelector("#player-field .game-board");y.querySelectorAll("button").forEach((s=>{s.addEventListener("mouseenter",(()=>{null!==u&&(m=d(s),p=h(u,s,g,m),c(y,p))})),s.addEventListener("click",(()=>{if(null!==p){const s=t.placeShipFor(1,p.getAttribute("data-ship-name"),Number(p.getAttribute("data-ship-length")),function(t,e){const r=Number(t.style.gridColumnStart),s=Number(t.style.gridRowStart),a=Number(t.getAttribute("data-ship-length")),n=[];for(let t=0;t<a;t+=1)"h"===e?n.push([r-1+t,s-1]):n.push([r-1,s-1+t]);return n}(p,g));s&&(r.setAttribute("disabled",!0),r.checked=!1,p.classList.remove("placeholder"),r=null,u=null,p=null,t.allShipsPlaced(1)&&function(t,e){t.classList.replace("grid-rows-[auto_auto_1fr]","grid-rows-[auto_1fr]"),t.querySelector("#ships-menu").remove();const r=t.querySelector("#opponent-field"),s=r.querySelector(".game-board");r.classList.remove("opacity-20");const a=t.querySelector("#player-field");a.querySelector(".field-header .title").textContent="Player1",a.querySelector(".field-header .desc").textContent="";const o=a.querySelector(".game-board");s.querySelectorAll("button").forEach((r=>{r.classList.add("hover:bg-slate-50/20"),r.addEventListener("click",(()=>{const s=d(r),a=e.playTurn(s);"invalid"!==a.playerShotStatus&&("hit"===a.playerShotStatus?r.classList.add("hit"):r.classList.add("miss")),a.aiShots.forEach((t=>{const e=(r=o,s={x:t.coordinate[0],y:t.coordinate[1]},r.children.item(10*s.y+s.x));var r,s;"hit"===t.shotStatus?e.classList.add("hit"):e.classList.add("miss")})),a.winner>0&&function(t,e){const r=function(t){const e=l("fixed w-full h-full bg-slate-900/50 grid items-center"),r=l("bg-red-700 text-slate-50 border-2","game-over p-4"),s=i("h3","title text-xl font-bold text-center font-display p-2");s.textContent="Game Over";const a=i("p","desc text-center text-2xl font-bold p-2");return a.textContent=`${t} won`,n(r,[s,a]),e.appendChild(r),e}(e);t.appendChild(r)}(t,1===a.winner?"Player":"Opponent")}))}))}(e,t))}}))})),window.addEventListener("keydown",(t=>{"KeyR"===t.code&&null!==u&&(t.preventDefault(),g="h"===g?"v":"h",null!==p&&(p=h(u,y.firstChild,g,m),c(y,p)))})),y.addEventListener("mouseleave",(()=>{var t;null!==(t=p)&&t.remove(),p=null}))};!function(){document.body.setAttribute("class","bg-gradient-to-b h-screen from-slate-950 to-slate-900");const t=function(){const t=l("grid h-screen items-center justify-center","start-screen"),e=i("button","rounded-full bg-amber-400 px-4 py-2 font-bold text-xl text-slate-900 hover:bg-amber-300 active:bg-amber-500",["id","start-button"]);return e.textContent="Start Battleship",t.appendChild(e),t}();document.body.appendChild(t),t.querySelector("#start-button").addEventListener("click",u)}()})();
//# sourceMappingURL=app21abbde54e9ad9e2af50.js.map